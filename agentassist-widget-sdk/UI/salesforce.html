<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=0.1, maximum-scale=1.0">
        <title>Agentassist</title>
        <link rel="icon" id="favicon" type="image/x-icon" href="favicon.ico">
        <link href="./css/reset.css" rel="stylesheet"></link>
        <link href="./fonts/inter.css" rel="stylesheet"></link>
        <link href="./css/styles.css" rel="stylesheet"></link>
        <link href="fonts/AgentAssist-icons/style.css" rel="stylesheet"></link>
        <script src="libs/kore-no-conflict-start.js" type="text/javascript"></script>
        <script src="libs/jquery.js" type="text/javascript"></script>
        <script src="libs/jquery.tmpl.min.js" type="text/javascript"></script>
        <script src="libs/jquery-ui.min.js" type="text/javascript"></script>
        <link href="libs/jquery-ui.min.css" rel="stylesheet"></link>
        <script src="libs/moment.js" type="text/javascript"></script>
        <script src="../libs/ie11CustomProperties.js"></script>
        <script src="../libs/lodash.min.js"></script>
        <script src="../libs/d3.v4.min.js"></script>
        <script src="../libs/KoreGraphAdapter.js" type="text/javascript"></script>
        <script src='../libs/anonymousassertion.js'></script>
        <script src="../kore-bot-sdk-client.js"></script>
        <script src="../libs/perfect-scrollbar.js" type="text/javascript"></script>

        <script src="chatWindow.js" type="text/javascript"></script>
        <script src="libs/jquery.daterangepicker.js" type="text/javascript"></script>
        <link href="libs/daterangepicker.css" rel="stylesheet"></link>
        <script src="libs/jquery-clockpicker.js" type="text/javascript"></script>
        <link href="libs/jquery-clockpicker.css" rel="stylesheet"></link>
        <link href="../libs/kore-pickers.css" rel="stylesheet"></link>
        <script src="../libs/kore-pickers.js" type="text/javascript"></script>
        <script src="../libs/emoji.js" type="text/javascript"></script>
        <script src="../libs/recorder.js" type="text/javascript"></script>
        <script src="../libs/recorderWorker.js" type="text/javascript"></script>
        <link href="chatWindow.css" rel="stylesheet"></link>
        <link href="../libs/emojione.sprites.css" rel="stylesheet"></link>
        <link href="../libs/purejscarousel.css" rel="stylesheet"></link>
        <script src="../libs/purejscarousel.js" type="text/javascript"></script>
        <script src="./custom/customTemplate.js" type="text/javascript"></script>
        <link href="../libs/prefect-scrollbar.css" rel="stylesheet"></link>
        <link href="./custom/customTemplate.css" rel="stylesheet"></link>
        <script src="kore-config.js" type="text/javascript"></script>
        <script src="kore-main.js" type="text/javascript"></script>
        <script src="libs/kore-no-conflict-end.js" type="text/javascript"></script>
        <script src="https://code.jquery.com/jquery-3.1.1.js"
            integrity="sha256-16cdPddA6VdVInumRGo6IbivbERE8p7CQR3HzTBuELA=" crossorigin="anonymous"></script>
        <script src="agentindex.js" type="text/javascript"></script>
        <script>
            var token;
            var botID;
            var agentAssistUrl;
            function getToken() {
                const params = new Proxy(new URLSearchParams(window.location.search), {
                    get: (searchParams, prop) => searchParams.get(prop),
                });
                token = params.token;
                botID = params.botid;
                agentAssistUrl = params.agentassisturl;
                console.log("token and botid", token, botID, agentAssistUrl);
            }
            getToken();
           
           
            if (!token || !botID || !agentAssistUrl) {
                console.error("token or botid not specified");
                alert("error")
            } else {
                grantCall();
            }
            function grantCall(){
                var payload = {
                    "assertion": token,
                    "botInfo": {
                        "chatBot": "sample Bot",
                        "taskBotId": botID
                    },
                    "token": {}
                }
                $.ajax({
                    url: agentAssistUrl + '/api/oAuth/token/jwtgrant',
                    type: 'POST',
                    crossDomain: true,
                    contentType: 'application/json',
                    headers: {
                        'User-Agent': this.userAgent,
                        "content-type": 'application/json'
                    },
                    data: JSON.stringify(payload),
                    dataType: "json",
                    success: function (result) {
                        var chatConfig = window.KoreSDK.chatConfig;
                        var koreBot = koreBotChat();
                        if (chatConfig.agentAssist) {
                            var webSocketConnection = {
                                "path": "/agentassist/api/v1/chat/", transports: ['websocket', 'polling', 'flashsocket']
                            };

                            var connectionObj = {
                                webSocketConnectionDomain: agentAssistUrl + "/koreagentassist",
                                webSocketConnectionDetails: webSocketConnection,
                                botDetails: chatConfig.botOptions
                            }
                            conversationId = (new Date()).getTime() + '';
                            new AgentAssist('agent-assist-chat-container', conversationId, botID, connectionObj);
                        }
                    },
                    error: function (error) {
                        console.error("given token is wrong")
                    }
                });  
           }
        </script>
    </head>
    <body>
       
        <div class="agent-assist-chat-container kore-chat-window " id="agentWidget">
            <div class="header-top-bar">
                <!-- Header -->
                <div class="header-data">
                    <div class="main-title">
                        <div class="logo-icon">
                            <i class="ast-agentlogo"></i>
                        </div>
                        <span>AgentAssist</span>
                    </div>
                    <div class="powerdby">
                        <span>Powered by</span>
                        <img src="./images/korelogo.svg">
                    </div>
                </div>
                <!-- Tabs -->
                <div class="tab-toggles-sec">
                    <div class="top-tabs-actions">
                        <div class="tab-icon active-tab" id="userAutoIcon">
                            <i class="ast-bot" id="userBotIcon"></i>
                            <div class="title-tab" id="AssistLabel">Assist</div>
                            <div class="custom-tootltip-tabs">User Automation</div>
                        </div>
                        <div class="tab-icon" id="searchAutoIcon">
                            <i class="ast-library" id="searchIcon"></i>
                            <div class="title-tab" id="LibraryLabel">Library</div>
                            <div class="custom-tootltip-tabs">Search</div>
                        </div>
                        <div class="tab-icon" id="agentAutoIcon">
                            <i class="ast-automation" id="agentBotIcon"></i>
                            <div class="title-tab" id="MybotLabel">My Bot</div>
                            <div class="custom-tootltip-tabs">Agent Automation</div>
                        </div>
                        <div class="tab-icon" id="transcriptIcon">
                            <i class="ast-transcipt" id="scriptIcon"></i>
                            <div class="title-tab" id="transcriptLabel">Transcript</div>
                            <div class="custom-tootltip-tabs">Transcript</div>
                        </div>
                    </div>
                    <div class="taoggle-with-text">
                        <div class="t-title">Pro-active</div>
                        <label class="kr-sg-toggle">
                            <input id="check1" type="checkbox" checked>
                            <div for="check1" class="slider"></div>
                        </label>
                    </div>
                </div>
            </div>
            <div class="body-data-container if-suggestion-search" id="bodyContainer">
                <div class="dialog-task-data" id="dynamicBlocksData">

                    <div class="dynamic-block-content" id="dynamicBlock">
                        <div class="show-history-block" id="history-details-btn">
                            <button id="showHistory" class="ghost-btn">Show history</button>
                        </div>
                        <div class="show-back-recommendation-block hide">
                            <button id="backToRecommendation" class="ghost-btn">
                                <span class="back-icon">
                                    <i class="ast-carrotup"></i>
                                </span>
                                Back to recommendation
                            </button>
                        </div>
                        <div class="customer-feeling-text">
                            <img src="./images/smile-online.svg">
                            <span>Customer is feeling <b>happy</b></span>
                        </div>

                        <div class="empty-data-no-agents">
                            <div class="title">No intent identified yet</div>
                            <div class="desc-text">The bot will automatically suggest tasks here.</div>
                            <div class="desc-text">To start a manual task, go to “Library” and run a task as “Run with Agent
                                Input”</div>
                        </div>

                    </div>

                    <div class="agent-body-data-container hide" id="agentAutoContainer">
                        <div class="dynamic-block-content" id="myBotAutomationBlock">
                            <div class="show-history-block" id="agent-ran-history-details-btn">
                                <button id="agent-showHistory" class="ghost-btn">Show history</button>
                            </div>
                            <div class="show-back-recommendation-block hide">
                                <button id="agent-backToRecommendation" class="ghost-btn">
                                    <span class="back-icon">
                                        <i class="ast-carrotup"></i>
                                    </span>
                                    Back to recommendation
                                </button>
                            </div>
                            <div class="customer-feeling-text">
                                <img src="./images/smile-online.svg">
                                <span>Customer is feeling <b>happy</b></span>
                            </div>
                            <div class="empty-data-no-agents hide" id="noAutoRunning">
                                <div class="title">No intent identified yet</div>
                                <div class="desc-text">The bot will automatically suggest tasks here.</div>
                                <div class="desc-text">To start a manual task, go to “Library” and run a task as “Run
                                    with Agent Input”</div>
                            </div>
                        </div>
                    </div>

                    <div class="transcipt-only-calls-data hide" id="scriptContainer">
                        <div class="data-contnet">
                            <div class="other-user-bubble">
                                <div class="name-with-time">
                                    <div class="u-name">John Wick</div>
                                    <div class="u-time">2:29pm</div>
                                </div>
                                <div class="bubble-data">
                                    <div class="b-text">Hey jane, can you help me?</div>
                                </div>
                            </div>
                            <div class="current-user-bubble">
                                <div class="name-with-time">
                                    <div class="u-time">2:41pm</div>
                                    <div class="u-name">You</div>
                                </div>
                                <div class="bubble-data">
                                    <div class="b-text">How can I help you?</div>
                                </div>
                            </div>
                            <div class="other-user-bubble">
                                <div class="name-with-time">
                                    <div class="u-name">John Wick</div>
                                    <div class="u-time">2:29pm</div>
                                </div>
                                <div class="bubble-data">
                                    <div class="b-text">I want to return an item</div>
                                </div>
                            </div>
                            <div class="current-user-bubble">
                                <div class="name-with-time">
                                    <div class="u-time">2:41pm</div>
                                    <div class="u-name">You</div>
                                </div>
                                <div class="bubble-data">
                                    <div class="b-text">Yes, I'll help you with it</div>
                                </div>
                            </div>
                            <div class="other-user-bubble">
                                <div class="name-with-time">
                                    <div class="u-name">John Wick</div>
                                    <div class="u-time">2:29pm</div>
                                </div>
                                <div class="bubble-data">
                                    <div class="b-text">Sorry, I mean, edit my order</div>
                                    <div class="buld-count-utt">
                                        <i class="ast-bulb"></i>
                                        <span class="count-number">1</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="library-search-data-container hide" id="LibraryContainer">
                        <div class="search-block">
                            <div class="input-text-search library-search-div" id="search-block">
                                <input type="text" placeholder="Ask AgentAssist" class="input-text" id="librarySearch">
                                <i class="ast-search"></i>
                                <i class="ast-close close-search"></i>
                            </div>
                        </div>

                        <div class="show-back-recommendation-block  hide" id="backButton">
                            <button id="backToPreviousTab" class="ghost-btn">
                                <span class="back-icon">
                                    <i class="ast-carrotup"></i>
                                </span>
                                Back
                            </button>
                        </div>

                        <div class="dynamic-searchlibrary-data">
                            <div class="empty-library-data hide" id="noLibraryList">
                                <div class="img-block">
                                    <img src="./images/emptylibrary.svg">
                                </div>
                                <div class="title-empty">No items found</div>
                                <div class="desc-text">No usecases are configured for the bot.</div>
                            </div>
                            <div id="frequently-exhaustive">
                                <div class="frequently-asked" id="allAutomations-Exhaustivelist">

                                </div>
                            
                            </div>
                            <div class="intent-based-search" id="searchResults">
                                <div id="search-text-display"></div>

                            </div>
                        </div>
                        <div id="dialogs-faqs">
                        </div>
                    </div>

                </div>
            </div>
            <div class="sugestions-info-data">
                <input type="text" class="suggestion-input" id="agentSearch" placeholder="Ask AgentAssist">
                <i class="ast-search search-icon"></i>
                <i class="ast-close close-search"></i>
            </div>

            <div class="overlay-suggestions hide">
                <div class="suggestion-content" id="overLaySearch">
                </div>
            </div>

            <div class="overlay-delete-popup hide" id="interruptPopUp">
                <div class="delete-box-content">
                    <div class="header-text">You are interrupting the current task</div>
                    <div class="close-popup">
                        <i class="ast-close"></i>
                    </div>
                    <div class="desc-text-info">If you run the select task, the current task will be completely terminated.
                        Are you sure you want to continue with the selected task?</div>
                    <div class="btn-footer-info" id="interruptCancel">
                        <button class="btn-danger">Yes, continue</button>
                        <button class="btn-cancel">Cancel</button>
                    </div>
                </div>
            </div>

            <div class="overlay-delete-popup hide" id="terminatePopUp">
                <div class="delete-box-content">
                    <div class="header-text">Are you sure you want to terminate the current on going task?</div>
                    <div class="close-popup">
                        <i class="ast-close"></i>
                    </div>
                    <div class="desc-text-info">If you run the select task, the current task will be completely terminated.
                        Are you sure you want to continue with the selected task?</div>
                    <div class="btn-footer-info">
                        <button class="btn-danger">Yes</button>
                        <button class="btn-cancel">Cancel</button>
                    </div>
                </div>
            </div>

            <div class="footer-info" id="cust-feeling">
                <div class="event-bucket">
                    <img src="./images/bucket.svg">
                </div>
                <div class="customer-feeling-text">
                    <img src="./images/smile-online.svg">
                    <span>Customer is feeling <b>happy</b></span>
                </div>
            </div>
            <div class="entity-bucket-data hide">
                <div class="data-content-info">
                    <div class="scroll-data-bucket">
                        <div class="inner-data-content-cards">
                            <div class="entity-card">
                                <div class="icon-block">
                                    <i class="ast-entity-rule"></i>
                                </div>
                                <div class="content-info-block">
                                    <div class="title-main">“Book a Flight”</div>
                                    <div class="info-data">
                                        <div class="left-title">Source</div>
                                        <div class="right-title">: Hyderabad</div>
                                    </div>
                                    <div class="info-data">
                                        <div class="left-title">Destination</div>
                                        <div class="right-title">: London</div>
                                    </div>
                                    <div class="info-data">
                                        <div class="left-title">Date</div>
                                        <div class="right-title">: 03 06 2022</div>
                                    </div>
                                    <div class="info-data">
                                        <div class="left-title">Class</div>
                                        <div class="right-title">: -</div>
                                    </div>
                                </div>
                            </div>
                            <div class="entity-card">
                                <div class="icon-block">
                                    <i class="ast-entity-rule"></i>
                                </div>
                                <div class="content-info-block">
                                    <div class="title-main">“Book a Flight”</div>
                                    <div class="info-data">
                                        <div class="left-title">Source</div>
                                        <div class="right-title">: Hyderabad</div>
                                    </div>
                                    <div class="info-data">
                                        <div class="left-title">Destination</div>
                                        <div class="right-title">: London</div>
                                    </div>
                                    <div class="info-data">
                                        <div class="left-title">Date</div>
                                        <div class="right-title">: 03 06 2022</div>
                                    </div>
                                    <div class="info-data">
                                        <div class="left-title">Class</div>
                                        <div class="right-title">: -</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="footer-buckets">
                        <div class="title-block">
                            <img src="./images/bucket.svg">
                            <span>ENtity Bucket</span>
                        </div>
                        <div class="arrow-close-bucket">
                            <i class="ast-move-arrow"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>   

    </body>
</html>