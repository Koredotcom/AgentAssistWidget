<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=0.1, maximum-scale=1.0">
    <title>Agentassist</title>
    <link rel="icon" id="favicon" type="image/x-icon" href="favicon.ico">
    <link href="./../dist/kore-ai-agentassist-sdk.min.css" rel="stylesheet">
    </link>
    
    <script src="./../dist/kore-ai-agentassist-sdk.combined.js" type="text/javascript"></script>
    <script>
        $(document).ready(function () {
            var chatConfig = window.KoreSDK.chatConfig;
            // $('#botid').val(chatConfig.botOptions.botInfo._id);
            // $('#clientid').val(chatConfig.botOptions.clientId)
            // $('#clientsecret').val(chatConfig.botOptions.clientSecret)
            // $('#connect').click(() => {
                initAgentAssist(chatConfig);
            // });
        });
        function initAgentAssist(chatConfig) {
            if (chatConfig.agentAssist) {
            //    var connectionObj = {
            //         envinormentUrl: chatConfig.agentAssistUrl,
            //         botDetails: chatConfig.botOptions,
            //         isAuthentication: false
            //     }
            var token, botID, agentAssistUrl, conversationId;
                function getToken() {
                    const params = new Proxy(new URLSearchParams(window.location.search), {
                        get: (searchParams, prop) => searchParams.get(prop),
                    });
                    token = params.token;
                    botID = params.botid;
                    agentAssistUrl = params.agentassisturl;
                    conversationId = params.conversationid;
                  
                }
                getToken();
                if(!token || !botID || !agentAssistUrl) {
                  console.error("failed");
                }

                var connectionObj = {
                    envinormentUrl: agentAssistUrl,
                    jwtToken:token,
                    botDetails: {},
                    isAuthentication: false
                }
                // var conversationId;
                // conversationId = (new Date()).getTime() + '';
                // $('#details').val(`ConversationID: ${conversationId}`);
                // botID = $(`#botid`).val() ? $(`#botid`).val() : chatConfig.botOptions.botInfo._id;
                // connectionObj.botDetails.clientId = $(`#clientid`).val() ? $(`#clientid`).val() : connectionObj.botDetails.clientId;
                // connectionObj.botDetails.clientSecret = $(`#clientsecret`).val() ? $(`#clientsecret`).val() : connectionObj.botDetails.clientSecret;
                new AgentAssist('agent-assist-chat-container', conversationId, botID, connectionObj);
            }
        }

    </script>

</head>

<body>
    
        <div id="agent-assist-chat-container">

        </div>
    
</body>

</html>