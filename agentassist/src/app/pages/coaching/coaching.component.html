<div class="agents-container-wrapper">
    <div class="header-sec-top">
        <div class="main-heading">Coaching</div>
        <button class="kr-sg-button-primary btn_lg" (click)="openCoachingGroup(coachingConst.CREATE, {})">+ New Coaching Group</button>
    </div>

    <div class="tab-sec-details-wrapper">
        <div class="search-data-input">
            <div class="kr-sg-input-inline-search">
                <input type="text" placeholder="Search" class="input-search">
                <i class="icon-sa-conv-search search-icon"></i>
            </div>
        </div>
        <div class="agents-grid-data-table" cdkDropListGroup>
            <perfect-scrollbar class="scroll-data" #ps>
                <div id="accordion" class="agent-groups-table-container">
                    <div class="scrolltopdiv" [ngClass]="{'addIndex': dragStart}" (mouseleave)="clearInterVal()" (mouseenter)="topMouseOver()">
                    </div>
                    <div class="scrollbottomdiv" [ngClass]="{'addIndex': dragStart}" (mouseleave)="clearInterVal()" (mouseenter)="bottomMouseOver()">
                    </div>
                    <ng-container *ngFor="let res of respData.results; let i = index">
                        <div class="card_content" 
                        cdkDropList
                        cdkDropListSortingDisabled
                        [cdkDropListData]="res.rules"
                        (cdkDropListDropped)="drop($event)">
                            <div class="card_header" (click)="collapseAcc(i)">
                              <div data-toggle="collapse" data-parent="#accordion" [attr.href]="'#agentGroupData' + i" class="card_link collapsed" aria-expanded="false">
                                    <div class="accordion-content-header">
                                        <div class="left-title">
                                            <span>{{res.name}}</span>
                                            <i class="icon-sa-welcome-edit" (click)="$event.stopPropagation();openCoachingGroup(coachingConst.EDIT, res)"></i>
                                        </div>
                                        <div class="right-info">
                                            <div class="items-count">{{res.rules?.length}} Items</div>
                                            <button class="new-rule-btn" (click)="$event.stopPropagation();openFLowCreation(flowCreation)">+ New Rule</button>
                                            <div class="arrow-rotate">
                                                <i class="icon-sa-arrow-down"></i>
                                            </div>
                                        </div>
                                    </div>
                              </div>
                            </div>
                    
                            <div [attr.id]="'agentGroupData' + i" class="collapse inside-accordioncontent">
                              <perfect-scrollbar class="mx-h-300">                            
                                  <div class="card-body inner-accordion-table" >
                                    <div class="content-scroll-data-agents">
                                        <div class="shadow-freeze"></div>
                                        <div class="header-table-agents"                         >
                                            <div class="titles-data w-22">
                                                <div class="title-header">Rule name</div>
                                            </div>
                                            <div class="titles-data w-14">Actions</div>
                                            <div class="titles-data w-16">Description</div>
                                            <div class="titles-data w-14">ASSIGNED TO</div>
                                            <div class="titles-data w-16">Last UPDATED</div>
                                            <div class="titles-data w-9 text-right">Enabled</div>
                                        </div>
                                        <div class="body-data-table-wrapper-coaching" *ngFor="let rule of res?.rules" cdkDrag (cdkDragStarted)="dragStart=true" (cdkDragEnded)="dragStart=false;clearInterVal()">
                                            <div class="title-text rule-text w-22">{{rule.name}}</div>
                                            <div class="actions-info w-16">
                                                <button class="edit-btn">
                                                    <i class="icon-sa-welcome-edit"></i>
                                                </button>
                                                <button class="delete-btn">
                                                    <i class="icon-sa-welcome-delete"></i>
                                                </button>
                                            </div>
                                            <div class="title-text w-16">{{rule.description}}</div>
                                            <div class="title-text w-14">{{rule.assignedTo}}</div>
                                            <div class="title-text w-16">{{rule.lModOn}}</div>
                                            <div class="title-text last-updated-toggle w-9">
                                                <label class="kr-sg-toggle">
                                                    <input type="checkbox" [checked]="rule.isEnabled">
                                                    <div class="slider"></div>
                                                </label>
                                            </div>
                                            <div class="drag-drop-element" cdkDragHandle>
                                                <i class="icon-sa-elipse"></i>
                                            </div>
                                        </div>
                                    </div>
                                  </div>
                              </perfect-scrollbar>
                            </div>
                        </div>
                    </ng-container>
                </div>
            </perfect-scrollbar>
        </div>
    </div>
</div>


<app-slider-component id="newCoachingGroup" #newCoachingGroup='app-slider'>
    <app-coaching-group-create (onClose)="closeCoachingGroup($event)" [type]="coachGroupEvent" [data]="coachGroupData"></app-coaching-group-create>
</app-slider-component>


<ng-template #ruleDelete>
	<div class="dlete-rule-common-dialg">
        <div class="close-rule-modal" (click)="closeDeleteRule()">
            <i class="icon-sa-close"></i>
        </div>
        <div class="content-data">
            <div class="delete-icon">
                <i class="icon-sa-welcome-delete"></i>
            </div>
            <div class="info-titles">
                <div class="title">Delete Rule</div>
                <div class="desc-text">Are you sure you want to delete Negotiation?</div>
            </div>
        </div>
        <div class="btn-actions-footer">
            <button class="kr-sg-button-secondary btn_lg" (click)="closeDeleteRule()">No</button>
            <button class="kr-sg-button-danger btn_lg">Yes</button>
        </div>
    </div>
</ng-template>


<ng-template #flowCreation>
    <app-coaching-rule-create (onCloseRule)="closeFLowCreation($event)"></app-coaching-rule-create>
</ng-template>
