
<div class="step-creation-slider-data">
    <div class="tab-content-data">
        <div class="header-sec">
            <div class="title">{{'GUIDED_CHECKLIST.STEP_CONFIG.STEP_CONFIG' | translate}}</div>
            <div class="close-slider" (click)="close()">
                <i class="icon-sa-close"></i>
            </div>
        </div>
        <div class="tabs-info">
            <button class="tab-btn" [ngClass]="{'active-btn': basic}" (click)="basic = true" title="Configurations">{{'GUIDED_CHECKLIST.STEP_CONFIG.CONFIGS' | translate}}</button>
            <button class="tab-btn" [ngClass]="{'active-btn': !basic}" (click)="basic = false" title="Adherence">{{'GUIDED_CHECKLIST.STEP_CONFIG.ADHERENCE' | translate}}</button>
        </div>
        <div class="body-data">
            <perfect-scrollbar>
                <div class="inner-content-data" [formGroup]="stepForm">
                    <div [ngClass]="{'d-none': !basic}" class="p-24">
                        <div class="kr-sg-input-text m-b-12">
                            <div class="label-text">{{'GUIDED_CHECKLIST.STEP_CONFIG.STEPTITLE' | translate}}</div>
                            <input type="text" formControlName="name" maxlength="48" placeholder="{{'GUIDED_CHECKLIST.STEP_CONFIG.STEPTITLE' | translate}}" class="input-text">
                            <div class="count-char">0/48</div>
                        </div>
                        <div class="kr-sg-input-text-area">
                            <div class="label-text">{{'GUIDED_CHECKLIST.STEP_CONFIG.STEPBODY' | translate}}</div>
                            <textarea formControlName="description" placeholder="{{'GUIDED_CHECKLIST.STEP_CONFIG.STEPBODY' | translate}}" maxlength="200" class="input-text p-b-35 height_120"></textarea>
                            <div class="count-char">0/200</div>
                            <div class="kr-sg-checkbox">
                                <input id="checkbox-122" formControlName="isSendCopy" class="checkbox-custom" type="checkbox">
                                <label for="checkbox-122" class="checkbox-custom-label">{{'GUIDED_CHECKLIST.STEP_CONFIG.ENABLE_SEND_COPY_BTN' | translate}}</label>
                            </div>
                        </div>
                        <div class="confirmation-buttons-wrapper">
                            <div class="kr-sg-checkbox">
                                <input id="checkbox-16" class="checkbox-custom" type="checkbox" [checked]="showButtons" (change)="confirmButtons($event)">
                                <label for="checkbox-16" class="checkbox-custom-label">
                                    <div class="title">{{'GUIDED_CHECKLIST.STEP_CONFIG.ADD_BTNS' | translate}}</div>
                                    <div class="desc-desc">{{'GUIDED_CHECKLIST.STEP_CONFIG.ADD_CONFIRMATION_BTNS_AGENT_SELECT' | translate}}</div>
                                </label>
                            </div>
                            <div class="adding-buttons-wrapper" *ngIf="showButtons">
                                <div class="buttons-wrapper-content">
                                    <div class="buttons-add">
                                        <div class="title">{{'GUIDED_CHECKLIST.STEP_CONFIG.BTNS' | translate}}</div>
                                        <div class="kr-sg-dropdowns" ngbDropdown>
                                            <div class="dropdown dropdown-open">
                                                <button class="dropdown-toggle dropdown-input" ngbDropdownToggle>{{stepButtons[selectedStepButton] ? stepButtons[selectedStepButton] : ('GUIDED_CHECKLIST.STEP_CONFIG.SELECT_OPTION' | translate)}}</button>
                                                <ul class="dropdown-menu content-menu" ngbDropdownMenu>
                                                    <li ngbDropdownItem *ngFor="let obj of stepButtons | keyvalue" (click)="changeStepButton(obj.key)">
                                                        <div class="option-title">{{obj.value}}</div>
                                                    </li>
                                                    <li ngbDropdownItem class="disabled-item">
                                                        <div class="option-title">{{'GUIDED_CHECKLIST.STEP_CONFIG.CUSTOM' | translate}}</div>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                        <!-- <button class="add-btn">Add</button> -->
                                    </div>
                                    <!-- *ngIf="selectedStepButton == 'confirmation'" -->

                                    <ng-container >
                                        <div class="header-btn-table">
                                            <div class="title-btn">{{'GUIDED_CHECKLIST.STEP_CONFIG.BTN_NAME' | translate}}</div>
                                            <!-- <div class="title-btn">Mark step as...</div> -->
                                            <div class="title-btn"></div>
                                        </div>
                                        <ng-container>
                                            <div class="body-btn-table" *ngFor="let item of stepForm.controls['confirmButtons']?.value; let inx = index">
                                                <div class="btn-name" >
                                                    <div class="btn-tag">
                                                        <span class="btn-name-text" [ngStyle]="{'background': checklistConst[item.color], 'color' : item.color}">{{item.title | titlecase}}</span>
                                                        <span class="bg-color"></span>
                                                    </div>
                                                </div>
                                                <div class="mark-step" *ngIf="selectedStepButton !== 'confirmation'">
                                                    <div class="kr-sg-dropdowns" ngbDropdown>
                                                        <div class="dropdown dropdown-open">
                                                            <button class="dropdown-toggle dropdown-input" ngbDropdownToggle>{{  useCases[dialogId] ? useCases[dialogId] : ('GUIDED_CHECKLIST.STEP_CONFIG.SELECT_DIALOG' | translate)}}</button>
                                                            <ul class="dropdown-menu content-menu" ngbDropdownMenu>

                                                                <ng-container  *ngFor="let item of useCases | keyvalue">
                                                                    <li ngbDropdownItem [ngClass]="{'selected-item' : selectedRunDialog == item.value}"  (click)="selectedDiaog(item)" title="{{item.value}}">{{item.value}}</li>
                                                                </ng-container>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="actions">
                                                    <div class="choose-bg-color-dropdown" ngbDropdown placement="top">
                                                        <button class="dropdown-toggle dropdown-input" ngbDropdownToggle>
                                                            <span [ngStyle]="{'border': '1px solid '+ item.color}"></span>
                                                        </button>
                                                        <ul class="dropdown-menu" ngbDropdownMenu>
                                                            <div class="select-colors">
                                                                <ng-container *ngFor="let color of checklistConst | keyvalue">
                                                                    <li ngbDropdownItem
                                                                        [ngClass]="{'selected-color': color.value === item.color}"
                                                                        (click)="item.color = color.key; colorUpdate(color, inx);">
                                                                        <span [ngStyle]="{'border': '1px solid '+ color.key}"></span>
                                                                    </li>
                                                                </ng-container>
                                                            </div>
                                                        </ul>
                                                    </div>
                                                    <button class="delete-btn" [disabled]="stepForm.value?.confirmButtons?.length === 1" (click)="deleteButtons(inx)">
                                                        <i class="icon-sa-welcome-delete"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </ng-container>
                                    </ng-container>


                                    <!-- <div class="title-btn">Mark step as...</div> -->
                                    <!-- <ng-container *ngIf="selectedStepButton == 'runDialog'">
                                        <div class="header-btn-table">
                                            <div class="title-btn">Button Name</div>
                                            <div class="title-btn">Dialog to Run</div>
                                            <div class="title-btn"></div>
                                        </div>
                                        <ng-container>
                                            <div class="body-btn-table">
                                                <div class="btn-name" >
                                                    <div class="btn-tag">
                                                        <span class="btn-name-text" [ngStyle]="{'background': selectedRunColorCodeValue, 'color' : selectedRunColorCodeKey}">Run</span>
                                                        <span class="bg-color"></span>
                                                    </div>
                                                </div>

                                                <div class="mark-step">
                                                    <div class="kr-sg-dropdowns" ngbDropdown>
                                                        <div class="dropdown dropdown-open">
                                                            <button class="dropdown-toggle dropdown-input" ngbDropdownToggle>{{selectedRunDialog ? selectedRunDialog : 'Select a Dialog'}}</button>
                                                            <ul class="dropdown-menu content-menu" ngbDropdownMenu>

                                                                <ng-container  *ngFor="let item of runDialogList">
                                                                    <li ngbDropdownItem [ngClass]="{'selected-item' : selectedRunDialog == item.name}"  (click)="selectedRunDialog = item.name" title="{{item.name}}">{{item.name}}</li>
                                                                </ng-container>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="actions">
                                                    <div class="choose-bg-color-dropdown" ngbDropdown placement="top">
                                                        <button class="dropdown-toggle dropdown-input" ngbDropdownToggle>
                                                            <span [ngStyle]="{'border': '1px solid '+ selectedRunColorCodeKey}"></span>
                                                        </button>
                                                        <ul class="dropdown-menu" ngbDropdownMenu>
                                                            <div class="select-colors">
                                                                <ng-container *ngFor="let color of checklistConst | keyvalue">
                                                                    <li ngbDropdownItem
                                                                        [ngClass]="{'selected-color': color.value === selectedRunColorCodeValue}"
                                                                        (click)="colorUpdateRun(color);">
                                                                        <span [ngStyle]="{'border': '1px solid '+ color.key}"></span>
                                                                    </li>
                                                                </ng-container>
                                                            </div>
                                                        </ul>
                                                    </div>
                                                    <button class="delete-btn">
                                                        <i class="icon-sa-welcome-delete"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </ng-container>
                                    </ng-container> -->

                                </div>
                            </div>
                        </div>
                    </div>
                    <app-trigger-by #triggerBy [basic]="basic" [ngClass]="{'d-none': basic}" [adherenceForm]="stepForm"></app-trigger-by>
                </div>
            </perfect-scrollbar>
        </div>
        <div class="footer-actions">
            <button class="kr-sg-button-secondary btn_lg" (click)="close()">{{'GUIDED_CHECKLIST.CREATE_CHECKLIST.CANCEL' | translate}}</button>
            <button
                class="kr-sg-button-primary btn_lg"
                (click)="save()"
                *ngIf="createOrUpdateStep === 'create'"
                [disabled]="!stepForm?.valid">
                {{'GUIDED_CHECKLIST.CREATE_CHECKLIST.SAVE' | translate}}
            </button>
            <button
                class="kr-sg-button-primary btn_lg"
                (click)="update()"
                *ngIf="createOrUpdateStep === 'update'"
                [disabled]="!stepForm?.valid">
                {{'GUIDED_CHECKLIST.CREATE_CHECKLIST.UPDATE' | translate}}
            </button>
        </div>
    </div>
</div>
